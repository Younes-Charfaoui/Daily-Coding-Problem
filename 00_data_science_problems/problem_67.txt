This problem was asked by Twitter.

Assume you are given the below tables for the session activity of users. Write a query to assign ranks to users by the total session duration for the different session types they have had between a start date (2020-01-01) and an end date (2020-02-01).

Sessions
column_name	type
session_id	integer
user_id	integer
session_type	string
duration	integer
start_time	datetime
